{"version":3,"sources":["components/BoundingBox/BoundingBox.js","components/Segmentation/Segmentation.js","App.js","index.js"],"names":["BoundingBox","state","isDragging","direction","renderResizers","start","end","x","y","width","height","fill","style","cursor","onMouseDown","e","startResize","renderDeleteButton","Math","abs","fontWeight","onClick","handleDelete","handleDeleteMouseDown","stopPropagation","props","onDelete","id","onResize","onChange","movementY","movementX","setState","document","body","addEventListener","endResize","removeEventListener","onMouseMove","startDragging","handleMouseUp","endDragging","this","isNew","lastCoord","x1","x2","y1","y2","offset","stopColor","d","stroke","backgroundColor","fillOpacity","strokeWidth","handleClick","onMouseOver","handleMouseEnter","onMouseOut","handleMouseLeave","Component","minimumRectSize","Segmentation","formatCoordinates","rects","maxY","svgRef","current","getBoundingClientRect","map","rect","handleResize","currentWidth","ratio","currentHeight","getScaleAdjustedRects","coeff","getScaleCoefficient","c","imageOriginalWidth","endBoundingBox","handleMouseMove","newRect","setRectMinimumSize","find","isCreatingNew","filter","min","max","isMouseHover","startBoundingBox","frameBoundingRect","clientX","clientY","guid","handleChange","endX","endY","foundBox","box","React","createRef","_","debounce","img","Image","onload","target","src","imageUrl","window","throttle","adjusted","ref","backgroundImage","backgroundRepeat","backgroundSize","maxWidth","onMouseEnter","onMouseLeave","key","result","console","log","App","className","fontFamily","padding","boxSizing","color","margin","display","flexDirection","justifyContent","textAlign","textShadow","role","aria-label","marginLeft","position","top","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.0b783536.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\n\nexport class BoundingBox extends Component {\n  static propTypes = {\n    start: PropTypes.array.isRequired,\n    end: PropTypes.array,\n    onChange: PropTypes.func.isRequired,\n    onDelete: PropTypes.func.isRequired,\n    isNew: PropTypes.bool\n  };\n\n  state = {\n    isDragging: false,\n    direction: null\n  };\n\n  render() {\n    const { start, end, isNew } = this.props;\n    const lastCoord = start[0] - end[0];\n\n    // using path for future bounging box scalling\n    return (\n      <g>\n        <defs>\n          <linearGradient id='Gradient' x1='0' x2='0' y1='0' y2='1'>\n            <stop offset='0%' stopColor='#FEE140' />\n            <stop offset='100%' stopColor='#FA709A' />\n          </linearGradient>\n        </defs>\n        <path\n          d={`m ${start[0]} ${start[1]} l ${end[0] - start[0]} 0 l 0 ${end[1] -\n            start[1]} l ${lastCoord} 0 z`}\n          style={{\n            stroke: '#FEE140',\n            fill: 'url(#Gradient)',\n            backgroundColor: '#8EC5FC',\n            fillOpacity: '0.6',\n            strokeWidth: '1'\n          }}\n          onMouseDown={this.startDragging}\n          onClick={this.handleClick}\n          onMouseOver={this.handleMouseEnter}\n          onMouseOut={this.handleMouseLeave}\n        />\n\n        <g>\n          {!isNew && this.renderDeleteButton(start, end)}\n          {!isNew && this.renderResizers(start, end)}\n        </g>\n      </g>\n    );\n  }\n\n  renderResizers = (start, end) => {\n    const areaSize = 20;\n\n    return (\n      <>\n        <rect\n          x={start[0]}\n          y={start[1] - 10}\n          width={end[0] - start[0]}\n          height={areaSize}\n          fill={'rgba(0,0,0,0)'}\n          style={{\n            cursor: 'n-resize'\n          }}\n          onMouseDown={e => this.startResize(e, 'top')}\n        />\n        <rect\n          x={end[0] - 10}\n          y={start[1]}\n          width={areaSize}\n          height={end[1] - start[1]}\n          fill={'rgba(0,0,0,0)'}\n          style={{\n            cursor: 'e-resize'\n          }}\n          onMouseDown={e => this.startResize(e, 'right')}\n        />\n        <rect\n          x={start[0]}\n          y={end[1] - 10}\n          width={end[0] - start[0]}\n          height={areaSize}\n          fill={'rgba(0,0,0,0)'}\n          style={{\n            cursor: 's-resize'\n          }}\n          onMouseDown={e => this.startResize(e, 'bottom')}\n        />\n        <rect\n          x={start[0] - 10}\n          y={start[1]}\n          width={areaSize}\n          fill={'rgba(0,0,0,0)'}\n          height={end[1] - start[1]}\n          style={{\n            cursor: 'w-resize'\n          }}\n          onMouseDown={e => this.startResize(e, 'left')}\n        />\n      </>\n    );\n  };\n\n  renderDeleteButton = (start, end) => (\n    <text\n      x={start[0] + Math.abs(end[0] - start[0]) / 2 - 5}\n      y={start[1] + Math.abs(end[1] - start[1]) / 2 + 5}\n      style={{\n        fontWeight: 'bold',\n        cursor: 'pointer'\n      }}\n      fill='#FFF'\n      onClick={this.handleDelete}\n      onMouseDown={this.handleDeleteMouseDown}\n    >\n      âœ•\n    </text>\n  );\n\n  componentDidMount() {\n    document.addEventListener('mouseup', this.handleMouseUp);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('mouseup', this.handleMouseUp);\n  }\n\n  handleDelete = e => {\n    e.stopPropagation();\n    const { onDelete, id } = this.props;\n    onDelete(id);\n  };\n\n  handleDeleteMouseDown = e => e.stopPropagation();\n\n  onResize = e => {\n    const { direction } = this.state;\n    if (direction !== null) {\n      const { start, end, onChange } = this.props;\n      const { movementY, movementX } = e;\n\n      switch (direction) {\n        case 'top':\n          onChange(\n            start[0],\n            start[1] + movementY,\n            end[0],\n            end[1],\n            this.props.id\n          );\n          break;\n        case 'right':\n          onChange(\n            start[0],\n            start[1],\n            end[0] + movementX,\n            end[1],\n            this.props.id\n          );\n          break;\n        case 'bottom':\n          onChange(\n            start[0],\n            start[1],\n            end[0],\n            end[1] + movementY,\n            this.props.id\n          );\n          break;\n        case 'left':\n        default:\n          onChange(\n            start[0] + movementX,\n            start[1],\n            end[0],\n            end[1],\n            this.props.id\n          );\n      }\n    }\n  };\n\n  startResize = (e, direction) => {\n    e.stopPropagation();\n    this.setState({\n      direction\n    });\n    document.body.addEventListener('mousemove', this.onResize);\n  };\n\n  endResize = e => {\n    e.stopPropagation();\n    this.setState({\n      direction: null\n    });\n    document.body.removeEventListener('mousemove', this.onResize);\n  };\n\n  onMouseMove = e => {\n    const { isDragging } = this.state;\n    if (isDragging) {\n      const { movementX, movementY } = e;\n      const { start, end } = this.props;\n\n      this.props.onChange(\n        start[0] + movementX,\n        start[1] + movementY,\n        end[0] + movementX,\n        end[1] + movementY,\n        this.props.id\n      );\n    }\n  };\n\n  startDragging = e => {\n    e.stopPropagation();\n    document.body.addEventListener('mousemove', this.onMouseMove);\n    this.setState({\n      isDragging: true\n    });\n  };\n\n  handleMouseUp = e => {\n    const { direction, isDragging } = this.state;\n\n    if (direction) {\n      this.endResize(e);\n    }\n\n    if (isDragging) {\n      this.endDragging();\n    }\n  };\n\n  endDragging = () => {\n    document.body.removeEventListener('mousemove', this.onMouseMove);\n    this.setState({\n      isDragging: false\n    });\n  };\n}\n","import React from 'react';\nimport guid from 'uniqid';\nimport './Segmentation.css';\nimport { BoundingBox } from '../BoundingBox/BoundingBox';\nimport _ from 'lodash';\nimport PropTypes from 'prop-types';\n\nconst minimumRectSize = 50;\n\nclass Segmentation extends React.Component {\n  static propTypes = {\n    onChange: PropTypes.func.isRequired,\n    imageUrl: PropTypes.string.isRequired\n  };\n\n  constructor(props) {\n    super(props);\n    this.svgRef = React.createRef();\n    this.onChange = _.debounce(this.onChange, 400);\n    this.state = {\n      rects: [\n        {\n          start: [299, 84],\n          end: [407, 194],\n          id: guid()\n        }\n      ],\n      imageOriginalWidth: 0,\n      isMouseHover: false,\n      isCreatingNew: false\n    };\n  }\n\n  componentDidMount() {\n    var img = new Image();\n    img.onload = e => {\n      const { width, height } = e.target;\n      const ratio = height / width;\n      const currentWidth = this.svgRef.current.getBoundingClientRect().width;\n\n      this.setState({\n        imageOriginalWidth: width,\n        ratio,\n        currentHeight: currentWidth * ratio\n      });\n    };\n\n    img.src = this.props.imageUrl;\n    window.addEventListener('resize', _.throttle(this.handleResize, 500));\n  }\n\n  componentWillUnmount() {\n    document.body.removeEventListener('mousedown', this.startBoundingBox);\n    window.removeEventListener('resize', _.throttle(this.handleResize, 500));\n  }\n\n  formatCoordinates = rects => {\n    // SVG origin (0,0 point) of coordinate system is top left corner\n    // but we need origin at bottom left corner, so we need reverse Y coordinate\n    const maxY = this.svgRef.current.getBoundingClientRect().height;\n    return rects.map(rect => {\n      const { start, end } = rect;\n      return [[start[0], maxY - start[1]], [end[0], maxY - end[1]]];\n    });\n  };\n\n  onChange = () => {\n    const { onChange } = this.props;\n    const { rects } = this.state;\n    const formatted = this.formatCoordinates(rects);\n    onChange(formatted);\n  };\n\n  handleResize = e => {\n    const currentWidth = this.svgRef.current.getBoundingClientRect().width;\n    const { ratio } = this.state;\n    this.setState({\n      currentHeight: currentWidth * ratio\n    });\n  };\n\n  getScaleAdjustedRects = rects => {\n    const coeff = this.getScaleCoefficient();\n\n    return rects.map(rect => ({\n      ...rect,\n      start: rect.start.map(c => c * coeff),\n      end: rect.end.map(c => c * coeff)\n    }));\n  };\n\n  getScaleCoefficient = () => {\n    const currentWidth = this.svgRef.current.getBoundingClientRect().width;\n    const { imageOriginalWidth } = this.state;\n    return currentWidth / imageOriginalWidth;\n  };\n\n  render() {\n    const { rects } = this.state;\n    const adjusted = this.svgRef.current\n      ? this.getScaleAdjustedRects(rects)\n      : rects;\n    return (\n      <div>\n        <svg\n          ref={this.svgRef}\n          height={this.state.currentHeight}\n          width='100%'\n          style={{\n            backgroundImage: `url(\"${this.props.imageUrl}\")`,\n            backgroundRepeat: 'no-repeat',\n            backgroundSize: 'cover',\n            maxWidth: '100%'\n          }}\n          onMouseDown={this.startBoundingBox}\n          onMouseEnter={this.handleMouseEnter}\n          onMouseLeave={this.handleMouseLeave}\n        >\n          {adjusted.map(box => (\n            <BoundingBox\n              {...box}\n              key={box.id}\n              onChange={this.handleChange}\n              onDelete={this.handleDelete}\n            />\n          ))}\n        </svg>\n      </div>\n    );\n  }\n\n  endBoundingBox = e => {\n    const { onChange } = this;\n    document.removeEventListener('mouseup', this.endBoundingBox);\n    document.removeEventListener('mousemove', this.handleMouseMove);\n\n    const { rects } = this.state;\n    const newRect = this.setRectMinimumSize(rects.find(rect => rect.isNew));\n\n    this.setState(\n      {\n        isCreatingNew: false,\n        rects: [\n          ...rects.filter(rect => !rect.isNew),\n          {\n            ...newRect,\n            isNew: false\n          }\n        ]\n      },\n      () => onChange(this.state.rects)\n    );\n  };\n\n  setRectMinimumSize = rect => {\n    const { start, end } = rect;\n\n    if (Math.abs(start[0] - end[0]) < minimumRectSize) {\n      end[0] = start[0] + minimumRectSize;\n    }\n\n    if (Math.abs(start[1] - end[1]) < minimumRectSize) {\n      end[1] = start[1] + minimumRectSize;\n    }\n\n    return {\n      ...rect,\n      start: [Math.min(start[0], end[0]), Math.min(start[1], end[1])],\n      end: [Math.max(start[0], end[0]), Math.max(start[1], end[1])]\n    };\n  };\n\n  handleMouseMove = e => {\n    if (this.state.isCreatingNew && this.state.isMouseHover) {\n      const { movementX, movementY } = e;\n      const coeff = this.getScaleCoefficient();\n      const { rects } = this.state;\n      const newRect = rects.find(rect => rect.isNew);\n\n      this.setState({\n        rects: [\n          ...rects.filter(rect => !rect.isNew),\n          {\n            ...newRect,\n            end: [\n              newRect.end[0] + movementX / coeff,\n              newRect.end[1] + movementY / coeff\n            ]\n          }\n        ]\n      });\n    }\n  };\n\n  startBoundingBox = e => {\n    document.addEventListener('mouseup', this.endBoundingBox);\n    document.addEventListener('mousemove', this.handleMouseMove);\n\n    const frameBoundingRect = this.svgRef.current.getBoundingClientRect();\n    const { rects } = this.state;\n    const coeff = this.getScaleCoefficient();\n\n    this.setState({\n      isCreatingNew: true,\n      rects: [\n        ...rects,\n        {\n          start: [\n            (e.clientX - frameBoundingRect.x) / coeff,\n            (e.clientY - frameBoundingRect.y) / coeff\n          ],\n          end: [\n            (e.clientX - frameBoundingRect.x) / coeff,\n            (e.clientY - frameBoundingRect.y) / coeff\n          ],\n          isNew: true,\n          id: guid()\n        }\n      ]\n    });\n  };\n\n  handleDelete = id => {\n    this.setState(\n      {\n        rects: this.state.rects.filter(rect => rect.id !== id)\n      },\n      () => this.onChange()\n    );\n  };\n\n  handleMouseLeave = () => this.setState({ isMouseHover: false });\n\n  handleMouseEnter = () => this.setState({ isMouseHover: true });\n\n  handleChange = (x, y, endX, endY, id) => {\n    const coeff = this.getScaleCoefficient();\n    x = (x * 1) / coeff;\n    y = (y * 1) / coeff;\n    endX = (endX * 1) / coeff;\n    endY = (endY * 1) / coeff;\n\n    if (!this.state.isMouseHover) return;\n\n    const { rects } = this.state;\n    const foundBox = rects.find(box => box.id === id);\n    let { width, height } = this.svgRef.current.getBoundingClientRect();\n\n    width = width / coeff;\n    height = height / coeff;\n    let start = [x, y];\n    let end = [endX, endY];\n\n    // checking svg borders on the y-axis\n    if (y <= 0 || endY >= height) {\n      start = [x, foundBox.start[1]];\n      end = [endX, foundBox.end[1]];\n    }\n\n    // checking svg borders on the x-axis\n    if (x < 0 || endX > width) {\n      start = [foundBox.start[0], y];\n      end = [foundBox.end[0], endY];\n    }\n\n    this.setState(\n      {\n        rects: [\n          ...rects.filter(box => box.id !== id),\n          {\n            ...foundBox,\n            start,\n            end\n          }\n        ]\n      },\n      () => this.onChange()\n    );\n  };\n}\n\nexport default Segmentation;\n","import React from 'react';\nimport Segmentation from './components/Segmentation/Segmentation';\nimport './App.css';\n\nconst handleChange = result => console.log('result: ', result);\nconst imageUrl = 'https://try.handl.ai/static/demo/aabb/appartment.jpg';\n\nfunction App() {\n  return (\n    <div\n      className='App'\n      style={{\n        fontFamily: `'Lato',  Arial, Helvetica, sans-serif`,\n        padding: '30px 50px',\n        backgroundColor: '#8EC5FC',\n        backgroundImage: 'linear-gradient(62deg, #8EC5FC 0%, #E0C3FC 100%)',\n        height: '100vh',\n        boxSizing: 'border-box',\n        color: '#fff'\n      }}\n    >\n      <div\n        style={{\n          maxWidth: '1200px',\n          margin: '0 auto',\n          display: 'flex',\n          flexDirection: 'column',\n          height: '100%',\n          justifyContent: 'space-between'\n        }}\n      >\n        <div>\n          <header className='App-header' style={{ height: 100 }}>\n            <h1\n              style={{\n                textAlign: 'center',\n                color: '#fff',\n                textShadow:\n                  '-1px -1px 1px rgba(255,255,255,.1), 1px 1px 1px rgba(0,0,0,.15)'\n              }}\n            >\n              Bounding Box Tool{' '}\n              <span role='img' aria-label='BB'>\n                ðŸ”±\n              </span>\n            </h1>\n          </header>\n          <div style={{ maxWidth: '100%', display: 'flex' }}>\n            <div style={{ width: '70%' }}>\n              <Segmentation onChange={handleChange} imageUrl={imageUrl} />\n            </div>\n            <h2\n              style={{\n                textAlign: 'left',\n                marginLeft: '60px',\n                width: '30%',\n                position: 'relative',\n                textShadow:\n                  '-1px -1px 1px rgba(255,255,255,.1), 1px 1px 1px rgba(0,0,0,.15)'\n              }}\n            >\n              <span style={{ position: 'absolute', top: '-30px' }}>ðŸ‘ˆ</span>{' '}\n              Mark any objects <br />\n              you like in the image <br />\n              and see result <br />\n              in devtools console{' '}\n            </h2>\n          </div>\n        </div>\n\n        <footer style={{ textAlign: 'center' }}>\n          By Denis Zuykov with <span>ðŸ–¤</span>\n        </footer>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}